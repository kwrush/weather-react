import { formatWeatherData, formatGeoSuggestion } from '../formatters'; 

const weatherJson = {
  "latitude":37.779999,
  "longitude":-122.419998,
  "timezone":"America/Los_Angeles",
  "offset":-7,
  "currently":{
    "time":1503430449,
    "summary":"Partly Cloudy",
    "icon":"partly-cloudy-day",
    "nearestStormDistance":0,
    "precipIntensity":0.0762,
    "precipIntensityError":0,
    "precipProbability":0.29,
    "precipType":"rain",
    "temperature":20.1,
    "apparentTemperature":20.1,
    "dewPoint":14.93,
    "humidity":0.72,
    "windSpeed":2.91,
    "windGust":3.06,
    "windBearing":249,
    "visibility":16.09,
    "cloudCover":0.3,
    "pressure":1016.9,
    "ozone":305.56,
    "uvIndex":7
  },
  "daily":{
    "summary":"No precipitation throughout the week, with temperatures rising to 24Â°C on Sunday.",
    "icon":"clear-day",
    "data":[
      {
        "time":1503385200,
        "summary":"Foggy overnight.",
        "icon":"fog",
        "sunriseTime":1503408777,
        "sunsetTime":1503456898,
        "moonPhase":0.04,
        "precipIntensity":0.0102,
        "precipIntensityMax":0.0432,
        "precipIntensityMaxTime":1503464400,
        "precipProbability":0.02,
        "precipType":"rain",
        "temperatureMin":15.14,
        "temperatureMinTime":1503468000,
        "temperatureMax":21.42,
        "temperatureMaxTime":1503439200,
        "apparentTemperatureMin":15.14,
        "apparentTemperatureMinTime":1503468000,
        "apparentTemperatureMax":21.42,
        "apparentTemperatureMaxTime":1503439200,
        "dewPoint":13.99,
        "humidity":0.8,
        "windSpeed":2.17,
        "windGust":5.9,
        "windGustTime":1503450000,
        "windBearing":262,
        "visibility":15.61,
        "cloudCover":0.34,
        "pressure":1016.34,
        "ozone":306.81,
        "uvIndex":8,
        "uvIndexTime":1503432000
      },
      {
        "time":1503471600,
        "summary":"Foggy in the morning.",
        "icon":"fog",
        "sunriseTime":1503495229,
        "sunsetTime":1503543216,
        "moonPhase":0.07,
        "precipIntensity":0.0178,
        "precipIntensityMax":0.0406,
        "precipIntensityMaxTime":1503496800,
        "precipProbability":0.02,
        "precipType":"rain",
        "temperatureMin":13.82,
        "temperatureMinTime":1503496800,
        "temperatureMax":20.12,
        "temperatureMaxTime":1503529200,
        "apparentTemperatureMin":13.82,
        "apparentTemperatureMinTime":1503496800,
        "apparentTemperatureMax":20.12,
        "apparentTemperatureMaxTime":1503529200,
        "dewPoint":14.09,
        "humidity":0.88,
        "windSpeed":3.29,
        "windGust":5.64,
        "windGustTime":1503532800,
        "windBearing":245,
        "visibility":12.42,
        "cloudCover":0.49,
        "pressure":1013.89,
        "ozone":293.34,
        "uvIndex":7,
        "uvIndexTime":1503518400
      },
      {
        "time":1503558000,
        "summary":"Partly cloudy throughout the day.",
        "icon":"partly-cloudy-day",
        "sunriseTime":1503581680,
        "sunsetTime":1503629532,
        "moonPhase":0.11,
        "precipIntensity":0.0229,
        "precipIntensityMax":0.0584,
        "precipIntensityMaxTime":1503579600,
        "precipProbability":0.04,
        "precipType":"rain",
        "temperatureMin":14.16,
        "temperatureMinTime":1503586800,
        "temperatureMax":20.4,
        "temperatureMaxTime":1503615600,
        "apparentTemperatureMin":14.17,
        "apparentTemperatureMinTime":1503586800,
        "apparentTemperatureMax":20.4,
        "apparentTemperatureMaxTime":1503615600,
        "dewPoint":14.08,
        "humidity":0.87,
        "windSpeed":3.55,
        "windGust":7.28,
        "windGustTime":1503626400,
        "windBearing":250,
        "visibility":16.09,
        "cloudCover":0.48,
        "pressure":1011.58,
        "ozone":283.31,
        "uvIndex":7,
        "uvIndexTime":1503604800
      },
      {
        "time":1503644400,
        "summary":"Partly cloudy until evening.",
        "icon":"partly-cloudy-day",
        "sunriseTime":1503668132,
        "sunsetTime":1503715848,
        "moonPhase":0.14,
        "precipIntensity":0.0254,
        "precipIntensityMax":0.0635,
        "precipIntensityMaxTime":1503655200,
        "precipProbability":0.05,
        "precipType":"rain",
        "temperatureMin":13.51,
        "temperatureMinTime":1503669600,
        "temperatureMax":20.74,
        "temperatureMaxTime":1503702000,
        "apparentTemperatureMin":13.51,
        "apparentTemperatureMinTime":1503669600,
        "apparentTemperatureMax":20.74,
        "apparentTemperatureMaxTime":1503702000,
        "dewPoint":13.52,
        "humidity":0.85,
        "windSpeed":2.98,
        "windGust":5.71,
        "windGustTime":1503644400,
        "windBearing":248,
        "visibility":16.09,
        "cloudCover":0.35,
        "pressure":1010.47,
        "ozone":278.52,
        "uvIndex":7,
        "uvIndexTime":1503691200
      },
      {
        "time":1503730800,
        "summary":"Clear throughout the day.",
        "icon":"clear-day",
        "sunriseTime":1503754583,
        "sunsetTime":1503802164,
        "moonPhase":0.17,
        "precipIntensity":0,
        "precipIntensityMax":0,
        "precipProbability":0,
        "temperatureMin":13.61,
        "temperatureMinTime":1503756000,
        "temperatureMax":23.18,
        "temperatureMaxTime":1503788400,
        "apparentTemperatureMin":13.61,
        "apparentTemperatureMinTime":1503756000,
        "apparentTemperatureMax":23.18,
        "apparentTemperatureMaxTime":1503788400,
        "dewPoint":13.63,
        "humidity":0.81,
        "windSpeed":1.69,
        "windGust":4.33,
        "windGustTime":1503792000,
        "windBearing":252,
        "cloudCover":0,
        "pressure":1012.58,
        "ozone":279.53,
        "uvIndex":9,
        "uvIndexTime":1503777600
      },
      {
        "time":1503817200,
        "summary":"Clear throughout the day.",
        "icon":"clear-day",
        "sunriseTime":1503841034,
        "sunsetTime":1503888478,
        "moonPhase":0.2,
        "precipIntensity":0,
        "precipIntensityMax":0,
        "precipProbability":0,
        "temperatureMin":14.07,
        "temperatureMinTime":1503842400,
        "temperatureMax":24.5,
        "temperatureMaxTime":1503874800,
        "apparentTemperatureMin":14.07,
        "apparentTemperatureMinTime":1503842400,
        "apparentTemperatureMax":24.5,
        "apparentTemperatureMaxTime":1503874800,
        "dewPoint":13.38,
        "humidity":0.76,
        "windSpeed":1.37,
        "windGust":4.22,
        "windGustTime":1503878400,
        "windBearing":263,
        "cloudCover":0,
        "pressure":1013.31,
        "ozone":275.98,
        "uvIndex":9,
        "uvIndexTime":1503864000
      },
      {
        "time":1503903600,
        "summary":"Clear throughout the day.",
        "icon":"clear-day",
        "sunriseTime":1503927486,
        "sunsetTime":1503974792,
        "moonPhase":0.23,
        "precipIntensity":0,
        "precipIntensityMax":0,
        "precipProbability":0,
        "temperatureMin":14.26,
        "temperatureMinTime":1503928800,
        "temperatureMax":23.84,
        "temperatureMaxTime":1503961200,
        "apparentTemperatureMin":14.26,
        "apparentTemperatureMinTime":1503928800,
        "apparentTemperatureMax":23.84,
        "apparentTemperatureMaxTime":1503961200,
        "dewPoint":12.97,
        "humidity":0.74,
        "windSpeed":1.55,
        "windGust":4.21,
        "windGustTime":1503964800,
        "windBearing":261,
        "cloudCover":0,
        "pressure":1010.88,
        "ozone":276.41,
        "uvIndex":9,
        "uvIndexTime":1503950400
      },
      {
        "time":1503990000,
        "summary":"Clear throughout the day.",
        "icon":"clear-day",
        "sunriseTime":1504013937,
        "sunsetTime":1504061105,
        "moonPhase":0.26,
        "precipIntensity":0,
        "precipIntensityMax":0,
        "precipProbability":0,
        "temperatureMin":14.59,
        "temperatureMinTime":1504015200,
        "temperatureMax":22.41,
        "temperatureMaxTime":1504044000,
        "apparentTemperatureMin":14.59,
        "apparentTemperatureMinTime":1504015200,
        "apparentTemperatureMax":22.41,
        "apparentTemperatureMaxTime":1504044000,
        "dewPoint":12.71,
        "humidity":0.74,
        "windSpeed":2.47,
        "windGust":5.03,
        "windGustTime":1504051200,
        "windBearing":264,
        "cloudCover":0,
        "pressure":1010.52,
        "ozone":277.73,
        "uvIndex":9,
        "uvIndexTime":1504036800
      }
    ]
  }
};

const suggestionJson = {
  "RESULTS":[
    {
      "name":"San Francisco, California",
      "type":"city",
      "c":"US",
      "zmw":"94102.1.99999",
      "tz":"America/Los_Angeles",
      "tzs":"PDT",
      "l":"/q/zmw:94102.1.99999",
      "ll":"37.779999 -122.419998",
      "lat":"37.779999",
      "lon":"-122.419998"
    },
    {
      "name":"San Fernando del Valle de Catamarca, Argentina",
      "type":"city",
      "c":"AR",
      "zmw":"00000.3.87222",
      "tz":"America/Argentina/Cordoba",
      "tzs":"-03",
      "l":"/q/zmw:00000.3.87222",
      "ll":"-28.469999 -65.779999",
      "lat":"-28.469999",
      "lon":"-65.779999"
    },
    {
      "name":"San Fernando, Spain",
      "type":"notcity",
      "c":"ES",
      "zmw":"00000.71.60030",
      "tz":"Atlantic/Canary",
      "tzs":"WEST",
      "l":"/q/zmw:00000.71.60030",
      "ll":"28.090000 -15.580000",
      "lat":"28.090000",
      "lon":"-15.580000"
    }
  ]
};

describe('respones formatter', () => {

    it('should format weather json correctly', () => {
        const formatted = formatWeatherData(weatherJson);
        expect(formatted.get('longitude')).toBe('-122.419998')
        expect(formatted.get('latitude')).toBe('37.779999');
        expect(formatted.getIn(['weather', 'currently', 'summary'])).toBe('Partly Cloudy');
        expect(formatted.getIn(['weather', 'currently', 'date'])).toBe('Aug 22, 2017');
        expect(formatted.getIn(['weather', 'daily']).size).toBe(5);
    });

    it('should foramt city information correctly', () => {
        const formatted = formatGeoSuggestion(suggestionJson);
        // filter the last entry since it's not a city
        expect(formatted.size).toBe(2);
        expect(formatted.getIn([0, 'fullName'])).toBe('San Francisco, California');
        expect(formatted.getIn([0, 'shortName'])).toBe('San Francisco');
    });
});

